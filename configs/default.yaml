seed: 1337

data:
  url: "https://raw.githubusercontent.com/shifatzaman/datasets/refs/heads/main/wfp_food_prices_bgd_updated.csv"
  country: "Bangladesh"
  currency: "BDT"
  market: "Dhaka Division"
  n_commodities: 2
  date_col: "date"
  commodity_col: "commodity"
  market_col: "market"
  price_col: "price"
  unit_col: "unit"
  freq: "ME"          # resample frequency (W = weekly). Options: D/W/M
  agg: "median"      # when resampling. Options: mean/median

task:
  input_len: 12      # history length (in resampled steps)
  horizon: 1         # forecast steps
  stride: 1
  scale: "minmax"    # standard|minmax|none
  target: "price"

split:
  train: 0.75
  val: 0.125
  test: 0.125
  time_based: true   # keep chronological order

teachers:
  # Any subset can be used as a teacher ensemble (see experiments.grid)
  common:
    hidden: 128
    dropout: 0.1
  models:
    dlinear:
      enabled: true
      decomposition_kernel: 25
    patchtst:
      enabled: true
      patch_len: 8
      d_model: 128
      nhead: 8
      num_layers: 3
      ff: 256
    nbeats:
      enabled: true
      stacks: 3
      blocks_per_stack: 3
      hidden: 256

students:
  common:
    hidden: 256
    dropout: 0.2
  models:
    mlp:
      enabled: true
      layers: [512, 256, 128]
    gru:
      enabled: true
      num_layers: 4
    kan:
      enabled: true
      grid_size: 32

distill:
  enabled: true
  uncertainty_weighted: true
  uncertainty_alpha: 2.0
  mode: "offline"     # offline only in this repo
  ensemble:
    weighting: "val_mae_softmax"  # uniform|val_mae_softmax
    temperature: 0.3
  losses:
    hard:
      type: "mae"        # mae or mse
      weight: 0.3
    kd_pred:
      enabled: true
      type: "mse"        # mse on predictions
      weight: 0.6
    kd_feat:
      enabled: true
      type: "mse"
      weight: 0.15
      projector: "mlp"   # mlp|linear
      proj_dim: 256
    kd_contrastive:
      enabled: false
      temperature: 0.2
      weight: 0.05
    kd_diff:
      enabled: true
      weight: 0.1

train:
  device: "auto"         # auto|cpu|cuda
  epochs: 100
  batch_size: 16
  lr: 2.0e-4
  weight_decay: 1.0e-5
  clip_grad: 1.0
  early_stopping:
    enabled: true
    patience: 15
    metric: "val_mae"
  num_workers: 0

experiments:
  # If grid.enabled is true, we try all combinations and log each run.
  grid:
    enabled: true
    teacher_sets:
      - ["dlinear"]
      - ["patchtst"]
      - ["nbeats"]
      - ["dlinear", "patchtst"]
      - ["dlinear", "nbeats"]
      - ["patchtst", "nbeats"]
      - ["dlinear", "patchtst", "nbeats"]
    students: ["mlp", "gru", "kan"]

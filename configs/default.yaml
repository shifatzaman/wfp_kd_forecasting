seed: 1337

data:
  url: "https://raw.githubusercontent.com/shifatzaman/datasets/refs/heads/main/wfp_food_prices_bgd_updated.csv"
  country: "Bangladesh"
  currency: "BDT"
  market: "Dhaka"
  n_commodities: 7
  date_col: "date"
  commodity_col: "commodity"
  market_col: "market"
  price_col: "price"
  unit_col: "unit"
  freq: "ME"          # resample frequency (W = weekly). Options: D/W/M
  agg: "median"      # when resampling. Options: mean/median

task:
  input_len: 24      # history length (in resampled steps)
  horizon: 1         # forecast steps
  stride: 1
  scale: "standard"  # standard|minmax|none
  target: "price"

split:
  train: 0.75
  val: 0.125
  test: 0.125
  time_based: true   # keep chronological order

teachers:
  # Any subset can be used as a teacher ensemble (see experiments.grid)
  common:
    hidden: 128
    dropout: 0.1
  models:
    dlinear:
      enabled: true
      decomposition_kernel: 25
    patchtst:
      enabled: true
      patch_len: 8
      d_model: 128
      nhead: 8
      num_layers: 3
      ff: 256
    nbeats:
      enabled: true
      stacks: 3
      blocks_per_stack: 3
      hidden: 256

students:
  common:
    hidden: 512
    dropout: 0.3
  models:
    mlp:
      enabled: true
      layers: [2048, 1024, 512, 256]
    gru:
      enabled: true
      num_layers: 5
    kan:
      enabled: true
      grid_size: 48

distill:
  enabled: true
  uncertainty_weighted: true
  uncertainty_alpha: 3.0
  mode: "offline"     # offline only in this repo
  ensemble:
    weighting: "val_mae_softmax"  # uniform|val_mae_softmax
    temperature: 0.15
  losses:
    hard:
      type: "mae"        # mae or mse
      weight: 0.2
    kd_pred:
      enabled: true
      type: "mse"        # mse on predictions
      weight: 0.7
    kd_feat:
      enabled: true
      type: "mse"
      weight: 0.25
      projector: "mlp"   # mlp|linear
      proj_dim: 512
    kd_contrastive:
      enabled: false
      temperature: 0.2
      weight: 0.05
    kd_diff:
      enabled: true
      weight: 0.2

train:
  device: "auto"         # auto|cpu|cuda
  epochs: 200
  batch_size: 4
  lr: 5.0e-5
  weight_decay: 1.0e-6
  clip_grad: 1.0
  early_stopping:
    enabled: true
    patience: 25
    metric: "val_mae"
  num_workers: 0

experiments:
  # If grid.enabled is true, we try all combinations and log each run.
  grid:
    enabled: true
    teacher_sets:
      - ["dlinear"]
      - ["patchtst"]
      - ["nbeats"]
      - ["dlinear", "patchtst"]
      - ["dlinear", "nbeats"]
      - ["patchtst", "nbeats"]
      - ["dlinear", "patchtst", "nbeats"]
    students: ["mlp", "gru", "kan"]
